<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AutoCompare â€” Car Insurance Cost Comparison</title>
<style>
/* â”€â”€ Reset & Base â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --navy: #1a2332;
  --navy-light: #243044;
  --navy-dark: #111824;
  --accent: #3b82f6;
  --accent-hover: #2563eb;
  --green: #10b981;
  --green-bg: #ecfdf5;
  --red: #ef4444;
  --red-bg: #fef2f2;
  --gray-50: #f9fafb;
  --gray-100: #f3f4f6;
  --gray-200: #e5e7eb;
  --gray-300: #d1d5db;
  --gray-400: #9ca3af;
  --gray-500: #6b7280;
  --gray-600: #4b5563;
  --gray-700: #374151;
  --gray-800: #1f2937;
  --white: #ffffff;
  --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
  --shadow: 0 1px 3px rgba(0,0,0,0.1), 0 1px 2px rgba(0,0,0,0.06);
  --shadow-md: 0 4px 6px rgba(0,0,0,0.07), 0 2px 4px rgba(0,0,0,0.06);
  --shadow-lg: 0 10px 15px rgba(0,0,0,0.1), 0 4px 6px rgba(0,0,0,0.05);
  --radius: 8px;
  --radius-lg: 12px;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  background: var(--gray-50);
  color: var(--gray-800);
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
}

/* â”€â”€ Header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
header {
  background: linear-gradient(135deg, var(--navy) 0%, var(--navy-light) 100%);
  color: var(--white);
  padding: 2rem 1rem;
  text-align: center;
}
header h1 {
  font-size: 1.75rem;
  font-weight: 700;
  letter-spacing: -0.025em;
  margin-bottom: 0.25rem;
}
header h1 span { color: var(--accent); }
header p {
  color: var(--gray-400);
  font-size: 0.95rem;
}

/* â”€â”€ Layout â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.container {
  max-width: 1100px;
  margin: 0 auto;
  padding: 0 1rem;
}

/* â”€â”€ Vehicle Selectors â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.selectors {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin: 2rem auto;
}
@media (max-width: 700px) {
  .selectors { grid-template-columns: 1fr; }
}

.vehicle-card {
  background: var(--white);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow);
  padding: 1.5rem;
  border-top: 3px solid var(--accent);
}
.vehicle-card.card-b { border-top-color: var(--navy); }
.vehicle-card h2 {
  font-size: 1rem;
  font-weight: 600;
  color: var(--gray-700);
  margin-bottom: 1rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}
.vehicle-card h2 .badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 24px; height: 24px;
  border-radius: 50%;
  font-size: 0.75rem;
  font-weight: 700;
  color: var(--white);
}
.card-a .badge { background: var(--accent); }
.card-b .badge { background: var(--navy); }

.field { margin-bottom: 1rem; }
.field label {
  display: block;
  font-size: 0.8rem;
  font-weight: 600;
  color: var(--gray-500);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-bottom: 0.35rem;
}
.field select {
  width: 100%;
  padding: 0.6rem 0.75rem;
  border: 1px solid var(--gray-300);
  border-radius: var(--radius);
  font-size: 0.95rem;
  background: var(--white);
  color: var(--gray-800);
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%236b7280' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 0.75rem center;
  cursor: pointer;
  transition: border-color 0.15s;
}
.field select:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(59,130,246,0.15);
}
.field select:disabled {
  background: var(--gray-100);
  color: var(--gray-400);
  cursor: not-allowed;
}

.vehicle-summary {
  margin-top: 0.75rem;
  padding: 0.75rem;
  background: var(--gray-50);
  border-radius: var(--radius);
  font-size: 0.85rem;
  color: var(--gray-600);
  min-height: 3.5rem;
  display: flex;
  align-items: center;
}
.vehicle-summary .detail-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0.25rem 1rem;
  width: 100%;
}
.vehicle-summary .detail-item {
  display: flex;
  gap: 0.25rem;
}
.vehicle-summary .detail-label {
  font-weight: 600;
  color: var(--gray-500);
  font-size: 0.75rem;
  text-transform: uppercase;
}
.vehicle-summary .detail-value {
  font-weight: 500;
  color: var(--gray-700);
}

/* â”€â”€ Compare Button â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.compare-section {
  text-align: center;
  margin: 0.5rem 0 2rem;
}
.btn-compare {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.85rem 2.5rem;
  background: var(--accent);
  color: var(--white);
  border: none;
  border-radius: var(--radius);
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.15s, transform 0.1s;
  box-shadow: var(--shadow-md);
}
.btn-compare:hover:not(:disabled) { background: var(--accent-hover); transform: translateY(-1px); }
.btn-compare:active:not(:disabled) { transform: translateY(0); }
.btn-compare:disabled { opacity: 0.5; cursor: not-allowed; }

/* â”€â”€ Spinner â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.spinner {
  display: none;
  text-align: center;
  padding: 2rem;
}
.spinner.visible { display: block; }
.spinner .dot-loader {
  display: inline-flex;
  gap: 0.4rem;
}
.spinner .dot {
  width: 10px; height: 10px;
  border-radius: 50%;
  background: var(--accent);
  animation: bounce 1.2s infinite ease-in-out;
}
.spinner .dot:nth-child(2) { animation-delay: 0.15s; }
.spinner .dot:nth-child(3) { animation-delay: 0.3s; }
@keyframes bounce {
  0%, 80%, 100% { transform: scale(0.6); opacity: 0.4; }
  40% { transform: scale(1); opacity: 1; }
}
.spinner p {
  margin-top: 0.75rem;
  font-size: 0.9rem;
  color: var(--gray-500);
}

/* â”€â”€ Results â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#results { display: none; }
#results.visible { display: block; }

.headline-card {
  background: var(--white);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-md);
  padding: 2rem;
  text-align: center;
  margin-bottom: 1.5rem;
}
.headline-card h3 {
  font-size: 1.35rem;
  font-weight: 700;
  color: var(--navy);
  line-height: 1.4;
}
.headline-card h3 .highlight {
  color: var(--accent);
}
.headline-card .sub {
  font-size: 0.9rem;
  color: var(--gray-500);
  margin-top: 0.5rem;
}

.results-actions {
  display: flex;
  justify-content: center;
  gap: 0.75rem;
  margin-bottom: 1.5rem;
  flex-wrap: wrap;
}
.btn-sm {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  padding: 0.5rem 1rem;
  border: 1px solid var(--gray-300);
  border-radius: var(--radius);
  background: var(--white);
  color: var(--gray-700);
  font-size: 0.85rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.15s;
}
.btn-sm:hover { background: var(--gray-50); border-color: var(--gray-400); }
.btn-sm svg { width: 16px; height: 16px; }

.btn-quote {
  background: var(--green);
  color: var(--white);
  border-color: var(--green);
  font-weight: 600;
}
.btn-quote:hover { background: #059669; border-color: #059669; }

/* â”€â”€ Factor Rows â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.factors-card {
  background: var(--white);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow);
  overflow: hidden;
  margin-bottom: 1.5rem;
}
.factors-header {
  display: grid;
  grid-template-columns: 2fr 1fr 1fr 60px;
  padding: 0.75rem 1.25rem;
  background: var(--gray-50);
  border-bottom: 1px solid var(--gray-200);
  font-size: 0.75rem;
  font-weight: 600;
  color: var(--gray-500);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}
@media (max-width: 600px) {
  .factors-header { grid-template-columns: 1.5fr 1fr 1fr 40px; padding: 0.75rem 0.75rem; }
}

.factor-row {
  display: grid;
  grid-template-columns: 2fr 1fr 1fr 60px;
  padding: 0.85rem 1.25rem;
  border-bottom: 1px solid var(--gray-100);
  align-items: center;
  font-size: 0.9rem;
  transition: background 0.1s;
}
.factor-row:hover { background: var(--gray-50); }
.factor-row:last-child { border-bottom: none; }
@media (max-width: 600px) {
  .factor-row { grid-template-columns: 1.5fr 1fr 1fr 40px; padding: 0.85rem 0.75rem; font-size: 0.8rem; }
}

.factor-name {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-weight: 600;
  color: var(--gray-700);
}
.factor-name .icon {
  width: 28px; height: 28px;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.85rem;
  flex-shrink: 0;
}
.factor-name .weight {
  font-size: 0.7rem;
  font-weight: 500;
  color: var(--gray-400);
  display: block;
  margin-top: 1px;
}
.factor-value { color: var(--gray-600); }
.factor-winner {
  text-align: center;
  font-weight: 700;
  font-size: 0.8rem;
}
.winner-a { color: var(--accent); }
.winner-b { color: var(--navy); }
.winner-tie { color: var(--gray-400); }

/* â”€â”€ Bar Chart â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.bar-chart-section {
  background: var(--white);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow);
  padding: 1.5rem;
  margin-bottom: 1.5rem;
}
.bar-chart-section h4 {
  font-size: 0.95rem;
  font-weight: 600;
  color: var(--gray-700);
  margin-bottom: 1rem;
}
.bar-row {
  display: flex;
  align-items: center;
  margin-bottom: 0.75rem;
  gap: 0.5rem;
}
.bar-label {
  width: 100px;
  font-size: 0.8rem;
  font-weight: 500;
  color: var(--gray-600);
  text-align: right;
  flex-shrink: 0;
}
@media (max-width: 500px) {
  .bar-label { width: 70px; font-size: 0.7rem; }
}
.bar-track {
  flex: 1;
  height: 24px;
  background: var(--gray-100);
  border-radius: 4px;
  position: relative;
  overflow: hidden;
  display: flex;
}
.bar-fill {
  height: 100%;
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.7rem;
  font-weight: 600;
  color: var(--white);
  min-width: 28px;
  transition: width 0.5s ease;
}
.bar-fill.fill-a { background: var(--accent); }
.bar-fill.fill-b { background: var(--navy-light); }

/* â”€â”€ Score Summary â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.score-cards {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1rem;
  margin-bottom: 1.5rem;
}
@media (max-width: 500px) { .score-cards { grid-template-columns: 1fr; } }

.score-card {
  background: var(--white);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow);
  padding: 1.25rem;
  text-align: center;
}
.score-card .car-label {
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--gray-500);
  margin-bottom: 0.25rem;
}
.score-card .car-name {
  font-size: 1rem;
  font-weight: 700;
  color: var(--navy);
  margin-bottom: 0.75rem;
}
.score-card .score-ring {
  width: 90px; height: 90px;
  margin: 0 auto 0.5rem;
  position: relative;
}
.score-card .score-ring svg { width: 90px; height: 90px; transform: rotate(-90deg); }
.score-card .score-ring circle {
  fill: none;
  stroke-width: 6;
}
.score-card .score-ring .track { stroke: var(--gray-200); }
.score-card .score-ring .fill { stroke-linecap: round; transition: stroke-dashoffset 0.6s ease; }
.score-card .score-number {
  position: absolute;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  font-size: 1.4rem;
  font-weight: 700;
  color: var(--navy);
}
.score-card .score-label {
  font-size: 0.8rem;
  color: var(--gray-500);
}
.score-low .fill { stroke: var(--green); }
.score-low .score-number { color: var(--green); }
.score-med .fill { stroke: #f59e0b; }
.score-med .score-number { color: #d97706; }
.score-high .fill { stroke: var(--red); }
.score-high .score-number { color: var(--red); }

/* â”€â”€ Disclaimer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.disclaimer {
  background: var(--gray-100);
  border-left: 3px solid var(--gray-300);
  padding: 1rem 1.25rem;
  border-radius: 0 var(--radius) var(--radius) 0;
  margin-bottom: 2rem;
  font-size: 0.82rem;
  color: var(--gray-500);
  line-height: 1.6;
}

/* â”€â”€ Popular Comparisons â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.popular-section {
  margin: 2rem 0 3rem;
}
.popular-section h3 {
  font-size: 1rem;
  font-weight: 600;
  color: var(--gray-700);
  margin-bottom: 1rem;
  text-align: center;
}
.popular-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 0.6rem;
  justify-content: center;
}
.popular-link {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  padding: 0.5rem 1rem;
  background: var(--white);
  border: 1px solid var(--gray-200);
  border-radius: 100px;
  font-size: 0.85rem;
  font-weight: 500;
  color: var(--gray-700);
  text-decoration: none;
  cursor: pointer;
  transition: all 0.15s;
}
.popular-link:hover {
  border-color: var(--accent);
  color: var(--accent);
  box-shadow: var(--shadow-sm);
}
.popular-link .vs {
  font-size: 0.7rem;
  font-weight: 700;
  color: var(--gray-400);
  text-transform: uppercase;
}

/* â”€â”€ Error â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.error-msg {
  display: none;
  background: var(--red-bg);
  border: 1px solid #fecaca;
  border-radius: var(--radius);
  padding: 0.75rem 1rem;
  color: var(--red);
  font-size: 0.85rem;
  margin: 1rem 0;
  text-align: center;
}
.error-msg.visible { display: block; }

/* â”€â”€ Footer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
footer {
  text-align: center;
  padding: 2rem 1rem;
  color: var(--gray-400);
  font-size: 0.8rem;
  border-top: 1px solid var(--gray-200);
}

/* â”€â”€ Toast â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.toast {
  position: fixed;
  bottom: 2rem;
  left: 50%;
  transform: translateX(-50%) translateY(100px);
  background: var(--navy);
  color: var(--white);
  padding: 0.65rem 1.25rem;
  border-radius: var(--radius);
  font-size: 0.85rem;
  font-weight: 500;
  box-shadow: var(--shadow-lg);
  opacity: 0;
  transition: transform 0.3s, opacity 0.3s;
  z-index: 1000;
  pointer-events: none;
}
.toast.show {
  transform: translateX(-50%) translateY(0);
  opacity: 1;
}

/* â”€â”€ Print â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
@media print {
  header { padding: 1rem; }
  .selectors, .compare-section, .results-actions, .popular-section, footer, .btn-sm, .toast { display: none !important; }
  #results { display: block !important; }
  .headline-card, .factors-card, .bar-chart-section, .score-cards .score-card { box-shadow: none; border: 1px solid var(--gray-200); }
  body { background: white; }
  .disclaimer { break-inside: avoid; }
}
</style>
</head>
<body>

<header>
  <h1><span>Auto</span>Compare</h1>
  <p>Estimate &amp; compare car insurance costs side by side</p>
</header>

<main class="container">

  <!-- Vehicle Selectors -->
  <div class="selectors">
    <div class="vehicle-card card-a" id="panel-a">
      <h2><span class="badge">A</span> Vehicle A</h2>
      <div class="field">
        <label for="year-a">Year</label>
        <select id="year-a"><option value="">Select yearâ€¦</option></select>
      </div>
      <div class="field">
        <label for="make-a">Make</label>
        <select id="make-a" disabled><option value="">Select makeâ€¦</option></select>
      </div>
      <div class="field">
        <label for="model-a">Model</label>
        <select id="model-a" disabled><option value="">Select modelâ€¦</option></select>
      </div>
      <div class="vehicle-summary" id="summary-a">Select a vehicle above</div>
    </div>

    <div class="vehicle-card card-b" id="panel-b">
      <h2><span class="badge">B</span> Vehicle B</h2>
      <div class="field">
        <label for="year-b">Year</label>
        <select id="year-b"><option value="">Select yearâ€¦</option></select>
      </div>
      <div class="field">
        <label for="make-b">Make</label>
        <select id="make-b" disabled><option value="">Select makeâ€¦</option></select>
      </div>
      <div class="field">
        <label for="model-b">Model</label>
        <select id="model-b" disabled><option value="">Select modelâ€¦</option></select>
      </div>
      <div class="vehicle-summary" id="summary-b">Select a vehicle above</div>
    </div>
  </div>

  <div class="error-msg" id="error-msg"></div>

  <div class="compare-section">
    <button class="btn-compare" id="btn-compare" disabled>
      <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M8 7h12M8 12h12M8 17h12M4 7h.01M4 12h.01M4 17h.01"/></svg>
      Compare Insurance Costs
    </button>
  </div>

  <!-- Loading Spinner -->
  <div class="spinner" id="spinner">
    <div class="dot-loader"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>
    <p>Fetching vehicle data &amp; safety ratingsâ€¦</p>
  </div>

  <!-- Results -->
  <div id="results">
    <div class="headline-card" id="headline"></div>

    <div class="results-actions">
      <button class="btn-sm" id="btn-share" title="Copy shareable link">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg>
        Share
      </button>
      <button class="btn-sm" id="btn-print" title="Print comparison">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9V2h12v7M6 18H4a2 2 0 01-2-2v-5a2 2 0 012-2h16a2 2 0 012 2v5a2 2 0 01-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></svg>
        Print
      </button>
      <a class="btn-sm btn-quote" href="#" target="_blank" id="btn-quote">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
        Get a Real Quote
      </a>
    </div>

    <!-- Score Cards -->
    <div class="score-cards" id="score-cards"></div>

    <!-- Bar Chart -->
    <div class="bar-chart-section" id="bar-chart">
      <h4>Factor-by-Factor Contribution</h4>
      <div id="bar-rows"></div>
    </div>

    <!-- Factor Breakdown -->
    <div class="factors-card">
      <div class="factors-header">
        <div>Factor</div>
        <div>Car A</div>
        <div>Car B</div>
        <div style="text-align:center">Edge</div>
      </div>
      <div id="factor-rows"></div>
    </div>

    <!-- Disclaimer -->
    <div class="disclaimer">
      <strong>Disclaimer:</strong> These are estimates based on vehicle characteristics. Actual insurance rates depend on your driving record, location, age, credit score, and chosen coverage levels. Get a real quote for accurate pricing.
    </div>
  </div>

  <!-- Popular Comparisons -->
  <div class="popular-section">
    <h3>Popular Comparisons</h3>
    <div class="popular-grid" id="popular-grid"></div>
  </div>

</main>

<footer>
  <p>AutoCompare &mdash; Vehicle data from NHTSA. For educational purposes only.</p>
</footer>

<div class="toast" id="toast"></div>

<script>
// â”€â”€â”€ Constants & Config â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const VPIC = 'https://vpic.nhtsa.dot.gov/api/vehicles';
const SAFETY = 'https://api.nhtsa.gov/SafetyRatings';
const YEARS = Array.from({ length: 12 }, (_, i) => 2026 - i); // 2026..2015

// Theft risk: common stolen models (lowercase)
const THEFT_HIGH = new Set([
  'civic', 'accord', 'cr-v',
  'elantra', 'sonata', 'tucson', 'santa fe',
  'optima', 'forte', 'sportage', 'soul', 'k5',
  'charger', 'challenger', 'durango',
  'silverado', 'silverado 1500', 'malibu', 'equinox',
  'f-150', 'f150', 'explorer', 'escape', 'fusion',
  'camry', 'corolla', 'rav4', 'highlander',
  'altima', 'rogue', 'sentra',
  'grand cherokee', 'cherokee', 'wrangler',
  'ram 1500', '1500',
]);

// Performance models (lowercase match patterns)
const PERFORMANCE_PATTERNS = [
  'mustang gt', 'mustang mach', 'shelby',
  'camaro ss', 'camaro zl1', 'camaro z28',
  'charger srt', 'charger r/t', 'challenger srt', 'challenger r/t', 'hellcat',
  'wrx sti', 'wrx',
  'corvette', 'viper',
  'gt-r', 'gtr', 'nismo',
  'type r', 'type-r',
  'amg', ' m2', ' m3', ' m4', ' m5', ' m8', 'm240', 'm340', 'm440', 'm550', 'm760',
  'rs3', 'rs4', 'rs5', 'rs6', 'rs7', ' s3', ' s4', ' s5', ' s6', ' s7', ' s8',
  'sti', 'trd pro',
  'trackhawk', 'demon',
  'model s plaid',
];

// Vehicle class keywords â†’ category
function classifyVehicle(bodyClass, modelName) {
  const b = (bodyClass || '').toLowerCase();
  const m = (modelName || '').toLowerCase();

  if (b.includes('sport') || m.includes('sport') || m.includes('coupe') && !m.includes('suv'))
    if (isPerformance(m)) return 'sports';
  if (b.includes('convertible') || b.includes('roadster')) return 'sports';
  if (isLuxury(m)) return 'luxury';
  if (b.includes('truck') || b.includes('pickup') || m.includes('pickup')) return 'truck';
  if (b.includes('suv') || b.includes('sport utility') || b.includes('crossover') ||
      m.includes('suv') || m.includes('crossover')) return 'suv';
  if (b.includes('sedan') || b.includes('hatchback') || b.includes('wagon')) return 'sedan';
  // Fallback heuristics on model name
  if (/\b(f-?150|silverado|sierra|tundra|tacoma|ranger|colorado|ram|frontier|titan|ridgeline|gladiator|maverick)\b/i.test(m)) return 'truck';
  if (/\b(rav4|cr-v|crv|escape|rogue|tucson|sportage|equinox|highlander|pilot|4runner|santa fe|cherokee|wrangler|bronco|tahoe|suburban|expedition|explorer|blazer|trailblazer|outlander|pathfinder|murano|atlas|tiguan|cx-5|cx-9|cx-50|forester|outback|ascent|sorento|telluride|model y|id\.4|ioniq 5|ev6|ariya|solterra|bz4x)\b/i.test(m)) return 'suv';
  return 'sedan';
}

function isLuxury(model) {
  return /\b(lexus|bmw|mercedes|audi|porsche|maserati|bentley|rolls|ferrari|lamborghini|aston|genesis|cadillac|lincoln|infiniti|acura|jaguar|land rover|range rover|volvo|alfa romeo|lotus)\b/i.test(model);
}

function isPerformance(model) {
  const m = model.toLowerCase();
  return PERFORMANCE_PATTERNS.some(p => m.includes(p));
}

function isHighTheft(model) {
  const m = model.toLowerCase();
  return [...THEFT_HIGH].some(t => m.includes(t));
}

// â”€â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let makesCache = null; // {MakeId, MakeName}[]
const state = {
  a: { year: '', makeId: '', makeName: '', modelName: '', details: null, safety: null },
  b: { year: '', makeId: '', makeName: '', modelName: '', details: null, safety: null },
};

// â”€â”€â”€ DOM Helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const $ = id => document.getElementById(id);
function showError(msg) { const el = $('error-msg'); el.textContent = msg; el.classList.add('visible'); }
function hideError() { $('error-msg').classList.remove('visible'); }
function showToast(msg) {
  const t = $('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2500);
}

function populateSelect(sel, items, valueProp, labelProp, placeholder) {
  sel.innerHTML = `<option value="">${placeholder}</option>`;
  items.forEach(it => {
    const o = document.createElement('option');
    o.value = it[valueProp];
    o.textContent = it[labelProp];
    if (it._extra) Object.entries(it._extra).forEach(([k, v]) => o.dataset[k] = v);
    sel.appendChild(o);
  });
  sel.disabled = false;
}

// â”€â”€â”€ API Fetchers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function fetchJSON(url) {
  const res = await fetch(url);
  if (!res.ok) throw new Error(`HTTP ${res.status}`);
  return res.json();
}

async function loadMakes() {
  if (makesCache) return makesCache;
  const data = await fetchJSON(`${VPIC}/GetMakesForVehicleType/car?format=json`);
  makesCache = (data.Results || [])
    .map(r => ({ MakeId: r.MakeId, MakeName: r.MakeName }))
    .sort((a, b) => a.MakeName.localeCompare(b.MakeName));
  return makesCache;
}

async function loadModels(make, makeId, year) {
  const data = await fetchJSON(
    `${VPIC}/GetModelsForMakeIdYear/makeId/${makeId}/modelyear/${year}/vehicletype/car?format=json`
  );
  const seen = new Set();
  return (data.Results || [])
    .filter(r => {
      const key = r.Model_Name;
      if (seen.has(key)) return false;
      seen.add(key);
      return true;
    })
    .map(r => ({ Model_Name: r.Model_Name }))
    .sort((a, b) => a.Model_Name.localeCompare(b.Model_Name));
}

async function loadVehicleDetails(makeId, year) {
  const data = await fetchJSON(
    `${VPIC}/GetModelsForMakeIdYear/makeId/${makeId}/modelyear/${year}/vehicletype/car?format=json`
  );
  return data.Results || [];
}

async function loadSafetyRatings(year, make, model) {
  try {
    const data = await fetchJSON(
      `${SAFETY}/modelyear/${year}/make/${encodeURIComponent(make)}/model/${encodeURIComponent(model)}?format=json`
    );
    if (data.Results && data.Results.length > 0) {
      return data.Results[0];
    }
    return null;
  } catch {
    return null;
  }
}

// â”€â”€â”€ Vehicle Detail Extraction â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function extractDetails(allVariants, modelName) {
  // Find a matching variant for the model
  const match = allVariants.find(v => v.Model_Name === modelName) || allVariants[0];
  return {
    bodyClass: match?.Body_Class || '',
    engineCylinders: match?.Engine_Cylinders || '',
    fuelType: match?.Fuel_Type || '',
    gvwr: match?.GVWR || '',
    vehicleType: match?.Vehicle_Type || '',
  };
}

// â”€â”€â”€ Scoring Model â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function computeScore(car) {
  const { year, makeName, modelName, details, safety } = car;
  const fullName = `${makeName} ${modelName}`;
  const bodyClass = details?.bodyClass || '';

  // Vehicle class (30%)
  const vClass = classifyVehicle(bodyClass, fullName);
  const classScores = { sedan: 0, suv: 10, sports: 25, luxury: 30, truck: 5 };
  const classPts = (classScores[vClass] || 0) * 0.30;

  // Safety rating (20%)
  const overallRating = safety?.OverallRating ? parseInt(safety.OverallRating, 10) : NaN;
  let safetyPts;
  if (isNaN(overallRating) || overallRating < 1 || overallRating > 5) {
    safetyPts = 12 * 0.20; // not rated
  } else {
    const safetyScores = { 5: 0, 4: 8, 3: 15, 2: 25, 1: 35 };
    safetyPts = (safetyScores[overallRating] || 12) * 0.20;
  }

  // Engine size (15%)
  const cyl = parseInt(details?.engineCylinders, 10);
  const fuel = (details?.fuelType || '').toLowerCase();
  let enginePts;
  if (fuel.includes('electric') || fuel.includes('ev')) {
    enginePts = 12 * 0.15;
  } else if (cyl >= 8) {
    enginePts = 15 * 0.15;
  } else if (cyl >= 6) {
    enginePts = 8 * 0.15;
  } else {
    enginePts = 0;
  }

  // Vehicle age (10%)
  const age = 2026 - parseInt(year, 10);
  const agePts = Math.max(0, 15 - age * 3) * 0.10;

  // Theft risk (15%)
  const theftPts = isHighTheft(fullName) ? 20 * 0.15 : 0;

  // Performance (10%)
  const perfPts = isPerformance(fullName) ? 20 * 0.10 : 0;

  const total = classPts + safetyPts + enginePts + agePts + theftPts + perfPts;

  return {
    total: Math.round(total * 10) / 10,
    factors: {
      vehicleClass: { value: vClass, pts: classPts, weight: 30 },
      safetyRating: { value: isNaN(overallRating) ? 'Not rated' : `${overallRating} star`, pts: safetyPts, weight: 20 },
      engineSize:   { value: fuel.includes('electric') ? 'Electric' : (cyl ? `${cyl}-cyl` : 'Unknown'), pts: enginePts, weight: 15 },
      vehicleAge:   { value: `${year} (${age}yr old)`, pts: agePts, weight: 10 },
      theftRisk:    { value: isHighTheft(fullName) ? 'High' : 'Normal', pts: theftPts, weight: 15 },
      performance:  { value: isPerformance(fullName) ? 'Performance' : 'Standard', pts: perfPts, weight: 10 },
    },
  };
}

// â”€â”€â”€ Setup Selectors â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function setupPanel(side) {
  const yearSel = $(`year-${side}`);
  const makeSel = $(`make-${side}`);
  const modelSel = $(`model-${side}`);
  const summaryEl = $(`summary-${side}`);

  YEARS.forEach(y => {
    const o = document.createElement('option');
    o.value = y; o.textContent = y;
    yearSel.appendChild(o);
  });

  yearSel.addEventListener('change', async () => {
    state[side].year = yearSel.value;
    state[side].makeId = '';
    state[side].makeName = '';
    state[side].modelName = '';
    state[side].details = null;
    state[side].safety = null;
    modelSel.innerHTML = '<option value="">Select modelâ€¦</option>';
    modelSel.disabled = true;
    summaryEl.textContent = 'Select a vehicle above';
    hideError();
    updateCompareBtn();

    if (!yearSel.value) {
      makeSel.innerHTML = '<option value="">Select makeâ€¦</option>';
      makeSel.disabled = true;
      return;
    }

    try {
      const makes = await loadMakes();
      populateSelect(makeSel, makes, 'MakeId', 'MakeName', 'Select makeâ€¦');
    } catch (e) {
      showError('Failed to load makes. Please try again.');
    }
  });

  makeSel.addEventListener('change', async () => {
    const opt = makeSel.options[makeSel.selectedIndex];
    state[side].makeId = makeSel.value;
    state[side].makeName = opt?.textContent || '';
    state[side].modelName = '';
    state[side].details = null;
    state[side].safety = null;
    summaryEl.textContent = 'Select a vehicle above';
    hideError();
    updateCompareBtn();

    if (!makeSel.value) {
      modelSel.innerHTML = '<option value="">Select modelâ€¦</option>';
      modelSel.disabled = true;
      return;
    }

    try {
      modelSel.innerHTML = '<option value="">Loadingâ€¦</option>';
      modelSel.disabled = true;
      const models = await loadModels(state[side].makeName, makeSel.value, state[side].year);
      if (models.length === 0) {
        modelSel.innerHTML = '<option value="">No models found</option>';
      } else {
        populateSelect(modelSel, models, 'Model_Name', 'Model_Name', 'Select modelâ€¦');
      }
    } catch (e) {
      modelSel.innerHTML = '<option value="">Error loading models</option>';
    }
  });

  modelSel.addEventListener('change', () => {
    state[side].modelName = modelSel.value;
    state[side].details = null;
    state[side].safety = null;
    hideError();
    updateCompareBtn();

    if (modelSel.value) {
      summaryEl.innerHTML = `<strong>${state[side].year} ${state[side].makeName} ${state[side].modelName}</strong>`;
    } else {
      summaryEl.textContent = 'Select a vehicle above';
    }
  });
}

function updateCompareBtn() {
  const ready = state.a.year && state.a.makeId && state.a.modelName &&
                state.b.year && state.b.makeId && state.b.modelName;
  $('btn-compare').disabled = !ready;
}

// â”€â”€â”€ Compare â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function runComparison() {
  hideError();
  $('results').classList.remove('visible');
  $('spinner').classList.add('visible');

  try {
    // Fetch details and safety for both cars in parallel
    const [detailsA, detailsB, safetyA, safetyB] = await Promise.all([
      loadVehicleDetails(state.a.makeId, state.a.year),
      loadVehicleDetails(state.b.makeId, state.b.year),
      loadSafetyRatings(state.a.year, state.a.makeName, state.a.modelName),
      loadSafetyRatings(state.b.year, state.b.makeName, state.b.modelName),
    ]);

    state.a.details = extractDetails(detailsA, state.a.modelName);
    state.b.details = extractDetails(detailsB, state.b.modelName);
    state.a.safety = safetyA;
    state.b.safety = safetyB;

    // Update summaries with detail grids
    renderDetailSummary('a');
    renderDetailSummary('b');

    const scoreA = computeScore(state.a);
    const scoreB = computeScore(state.b);

    renderResults(scoreA, scoreB);
    updateHash();
  } catch (e) {
    showError('Error fetching vehicle data. Some models may not have complete data. Please try different selections.');
  } finally {
    $('spinner').classList.remove('visible');
  }
}

function renderDetailSummary(side) {
  const s = state[side];
  const d = s.details || {};
  const summaryEl = $(`summary-${side}`);
  summaryEl.innerHTML = `
    <div class="detail-grid">
      <div class="detail-item"><span class="detail-label">Body:</span> <span class="detail-value">${d.bodyClass || 'â€”'}</span></div>
      <div class="detail-item"><span class="detail-label">Engine:</span> <span class="detail-value">${d.engineCylinders ? d.engineCylinders + '-cyl' : (d.fuelType || 'â€”')}</span></div>
      <div class="detail-item"><span class="detail-label">Fuel:</span> <span class="detail-value">${d.fuelType || 'â€”'}</span></div>
      <div class="detail-item"><span class="detail-label">Safety:</span> <span class="detail-value">${s.safety?.OverallRating ? s.safety.OverallRating + 'â˜…' : 'N/A'}</span></div>
    </div>
  `;
}

// â”€â”€â”€ Render Results â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderResults(scoreA, scoreB) {
  const nameA = `${state.a.year} ${state.a.makeName} ${state.a.modelName}`;
  const nameB = `${state.b.year} ${state.b.makeName} ${state.b.modelName}`;

  // Headline
  const diff = scoreB.total - scoreA.total;
  const pctDiff = scoreA.total > 0 ? Math.abs(Math.round((diff / Math.max(scoreA.total, 1)) * 100)) : 0;
  let headlineText;
  if (Math.abs(diff) < 1.5) {
    headlineText = `<span class="highlight">${nameA}</span> and <span class="highlight">${nameB}</span> are estimated to cost <span class="highlight">about the same</span> to insure`;
  } else if (diff > 0) {
    headlineText = `<span class="highlight">${nameB}</span> is estimated to cost <span class="highlight">~${pctDiff}% more</span> to insure than <span class="highlight">${nameA}</span>`;
  } else {
    headlineText = `<span class="highlight">${nameA}</span> is estimated to cost <span class="highlight">~${pctDiff}% more</span> to insure than <span class="highlight">${nameB}</span>`;
  }
  $('headline').innerHTML = `
    <h3>${headlineText}</h3>
    <div class="sub">Based on vehicle class, safety ratings, engine, age, theft risk &amp; performance</div>
  `;

  // Score cards
  renderScoreCards(nameA, scoreA.total, nameB, scoreB.total);

  // Bar chart
  renderBarChart(scoreA, scoreB);

  // Factor rows
  renderFactorRows(scoreA, scoreB);

  $('results').classList.add('visible');
  $('results').scrollIntoView({ behavior: 'smooth', block: 'start' });
}

function renderScoreCards(nameA, totalA, nameB, totalB) {
  function tierClass(score) {
    if (score < 6) return 'score-low';
    if (score < 12) return 'score-med';
    return 'score-high';
  }
  function tierLabel(score) {
    if (score < 6) return 'Lower risk';
    if (score < 12) return 'Moderate risk';
    return 'Higher risk';
  }
  function ringCircle(score) {
    const r = 38;
    const c = 2 * Math.PI * r;
    const pct = Math.min(score / 25, 1); // 25 max reasonable score
    const offset = c * (1 - pct);
    return `<svg viewBox="0 0 84 84"><circle class="track" cx="42" cy="42" r="${r}"/><circle class="fill" cx="42" cy="42" r="${r}" stroke-dasharray="${c}" stroke-dashoffset="${offset}"/></svg>`;
  }

  $('score-cards').innerHTML = `
    <div class="score-card ${tierClass(totalA)}">
      <div class="car-label">Car A</div>
      <div class="car-name">${nameA}</div>
      <div class="score-ring">${ringCircle(totalA)}<div class="score-number">${totalA}</div></div>
      <div class="score-label">${tierLabel(totalA)} Â· Cost Index</div>
    </div>
    <div class="score-card ${tierClass(totalB)}">
      <div class="car-label">Car B</div>
      <div class="car-name">${nameB}</div>
      <div class="score-ring">${ringCircle(totalB)}<div class="score-number">${totalB}</div></div>
      <div class="score-label">${tierLabel(totalB)} Â· Cost Index</div>
    </div>
  `;
}

const FACTOR_META = {
  vehicleClass:  { label: 'Vehicle Class', icon: 'ğŸš—', bg: '#eff6ff' },
  safetyRating:  { label: 'Safety Rating', icon: 'ğŸ›¡ï¸', bg: '#f0fdf4' },
  engineSize:    { label: 'Engine Size',   icon: 'âš™ï¸', bg: '#fefce8' },
  vehicleAge:    { label: 'Vehicle Age',   icon: 'ğŸ“…', bg: '#faf5ff' },
  theftRisk:     { label: 'Theft Risk',    icon: 'ğŸ”’', bg: '#fff7ed' },
  performance:   { label: 'Performance',   icon: 'ğŸï¸', bg: '#fef2f2' },
};

function renderBarChart(scoreA, scoreB) {
  const maxPts = Math.max(scoreA.total, scoreB.total, 1);
  let html = '';
  for (const [key, meta] of Object.entries(FACTOR_META)) {
    const a = scoreA.factors[key].pts;
    const b = scoreB.factors[key].pts;
    const barMax = Math.max(a, b, 0.5);
    const scale = 100 / (barMax * 1.3);
    html += `
      <div class="bar-row">
        <div class="bar-label">${meta.label}</div>
        <div class="bar-track">
          <div class="bar-fill fill-a" style="width:${Math.max(a * scale, 4)}%" title="Car A: ${a.toFixed(1)}">${a.toFixed(1)}</div>
        </div>
        <div class="bar-track">
          <div class="bar-fill fill-b" style="width:${Math.max(b * scale, 4)}%" title="Car B: ${b.toFixed(1)}">${b.toFixed(1)}</div>
        </div>
      </div>
    `;
  }
  $('bar-rows').innerHTML = html;
}

function renderFactorRows(scoreA, scoreB) {
  let html = '';
  for (const [key, meta] of Object.entries(FACTOR_META)) {
    const fA = scoreA.factors[key];
    const fB = scoreB.factors[key];
    let winner, winClass;
    if (Math.abs(fA.pts - fB.pts) < 0.3) {
      winner = 'â€”'; winClass = 'winner-tie';
    } else if (fA.pts < fB.pts) {
      winner = 'A'; winClass = 'winner-a';
    } else {
      winner = 'B'; winClass = 'winner-b';
    }

    html += `
      <div class="factor-row">
        <div class="factor-name">
          <div class="icon" style="background:${meta.bg}">${meta.icon}</div>
          <div>
            ${meta.label}
            <span class="weight">${fA.weight}% weight</span>
          </div>
        </div>
        <div class="factor-value">${fA.value}</div>
        <div class="factor-value">${fB.value}</div>
        <div class="factor-winner ${winClass}">${winner}</div>
      </div>
    `;
  }
  $('factor-rows').innerHTML = html;
}

// â”€â”€â”€ URL Hash â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function updateHash() {
  const p = new URLSearchParams();
  p.set('ay', state.a.year); p.set('am', state.a.makeName); p.set('ami', state.a.makeId); p.set('amod', state.a.modelName);
  p.set('by', state.b.year); p.set('bm', state.b.makeName); p.set('bmi', state.b.makeId); p.set('bmod', state.b.modelName);
  history.replaceState(null, '', '#' + p.toString());
}

async function loadFromHash() {
  if (!location.hash || location.hash.length < 2) return;
  try {
    const p = new URLSearchParams(location.hash.slice(1));
    const ay = p.get('ay'), am = p.get('am'), ami = p.get('ami'), amod = p.get('amod');
    const by = p.get('by'), bm = p.get('bm'), bmi = p.get('bmi'), bmod = p.get('bmod');
    if (!ay || !am || !ami || !amod || !by || !bm || !bmi || !bmod) return;

    // Set state
    state.a = { year: ay, makeName: am, makeId: ami, modelName: amod, details: null, safety: null };
    state.b = { year: by, makeName: bm, makeId: bmi, modelName: bmod, details: null, safety: null };

    // Set dropdowns
    await setVehicleFromHash('a', ay, ami, am, amod);
    await setVehicleFromHash('b', by, bmi, bm, bmod);

    updateCompareBtn();
    // Auto-compare
    await runComparison();
  } catch (e) {
    // silently fail â€” user can manually select
  }
}

async function setVehicleFromHash(side, year, makeId, makeName, modelName) {
  const yearSel = $(`year-${side}`);
  const makeSel = $(`make-${side}`);
  const modelSel = $(`model-${side}`);

  yearSel.value = year;

  // Load makes
  const makes = await loadMakes();
  populateSelect(makeSel, makes, 'MakeId', 'MakeName', 'Select makeâ€¦');
  makeSel.value = makeId;

  // Load models
  const models = await loadModels(makeName, makeId, year);
  populateSelect(modelSel, models, 'Model_Name', 'Model_Name', 'Select modelâ€¦');
  modelSel.value = modelName;

  $(`summary-${side}`).innerHTML = `<strong>${year} ${makeName} ${modelName}</strong>`;
}

// â”€â”€â”€ Popular Comparisons â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const POPULAR = [
  { a: { y: '2024', m: 'Honda', mi: '474', mod: 'Civic' },    b: { y: '2024', m: 'Toyota', mi: '448', mod: 'Corolla' },    label: ['Civic', 'Corolla'] },
  { a: { y: '2024', m: 'Tesla', mi: '441', mod: 'Model 3' },  b: { y: '2024', m: 'Tesla', mi: '441', mod: 'Model Y' },     label: ['Model 3', 'Model Y'] },
  { a: { y: '2024', m: 'Ford', mi: '460', mod: 'F-150' },     b: { y: '2024', m: 'Chevrolet', mi: '467', mod: 'Silverado 1500' }, label: ['F-150', 'Silverado'] },
  { a: { y: '2024', m: 'Toyota', mi: '448', mod: 'Camry' },   b: { y: '2024', m: 'Honda', mi: '474', mod: 'Accord' },      label: ['Camry', 'Accord'] },
  { a: { y: '2024', m: 'Toyota', mi: '448', mod: 'RAV4' },    b: { y: '2024', m: 'Honda', mi: '474', mod: 'CR-V' },        label: ['RAV4', 'CR-V'] },
];

function renderPopular() {
  $('popular-grid').innerHTML = POPULAR.map(p => {
    const params = new URLSearchParams();
    params.set('ay', p.a.y); params.set('am', p.a.m); params.set('ami', p.a.mi); params.set('amod', p.a.mod);
    params.set('by', p.b.y); params.set('bm', p.b.m); params.set('bmi', p.b.mi); params.set('bmod', p.b.mod);
    return `<a class="popular-link" href="#${params.toString()}" onclick="location.hash='${params.toString()}'; loadFromHash(); return false;">${p.label[0]} <span class="vs">vs</span> ${p.label[1]}</a>`;
  }).join('');
}

// â”€â”€â”€ Events â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function init() {
  setupPanel('a');
  setupPanel('b');
  renderPopular();

  $('btn-compare').addEventListener('click', runComparison);

  $('btn-share').addEventListener('click', () => {
    const url = location.href;
    if (navigator.clipboard) {
      navigator.clipboard.writeText(url).then(() => showToast('Link copied to clipboard'));
    } else {
      showToast('Copy this URL to share: ' + url);
    }
  });

  $('btn-print').addEventListener('click', () => window.print());

  // Load from hash if present
  loadFromHash();
}

document.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>
